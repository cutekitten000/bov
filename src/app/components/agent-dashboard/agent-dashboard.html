<div class="dashboard-container" *ngIf="agent$ | async as agent">
  
  <mat-toolbar class="main-toolbar" color="primary">
    <div class="toolbar-section">
      <span>Bem vindo, <strong>{{ agent.name }}</strong></span>
    </div>
    <div class="toolbar-section toolbar-center">
      <a mat-button>BOV EQUIPE</a>
      <a mat-button>Vendas do Dia</a>
      <a mat-button>Vendas de Ontem</a>
      <a mat-button>Links Úteis</a>
      <a mat-button>Baixar Planilha do Mês</a>
    </div>
    <div class="toolbar-section">
       <button mat-icon-button [matMenuTriggerFor]="userMenu">
        <mat-icon>account_circle</mat-icon>
      </button>
      <mat-menu #userMenu="matMenu">
        <button mat-menu-item>Meu Usuário</button>
        <button mat-menu-item (click)="logout()">Sair</button>
      </mat-menu>
    </div>
  </mat-toolbar>

  <main class="dashboard-content">
    <div class="kpi-cards-container">
      <mat-card *ngFor="let card of kpiCards" class="kpi-card" [ngClass]="card.color">
        <mat-card-header>
          <mat-card-title>{{ card.value }}</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <p>{{ card.title }}</p>
        </mat-card-content>
      </mat-card>
    </div>

    <div class="actions-bar">
      <div class="filter-inputs">
        Filtros aqui
      </div>
      <button mat-flat-button color="primary" (click)="openSaleDialog()">
        <mat-icon>add</mat-icon>
        Nova Venda
      </button>
    </div>

    <div class="table-container">
      <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">
        
        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef> Status </th>
          <td mat-cell *matCellDef="let element"> {{element.status}} </td>
        </ng-container>

        <ng-container matColumnDef="cpfCnpj">
          <th mat-header-cell *matHeaderCellDef> CPF/CNPJ </th>
          <td mat-cell *matCellDef="let element"> {{element.cpfCnpj}} </td>
        </ng-container>

        <ng-container matColumnDef="saleDate">
          <th mat-header-cell *matHeaderCellDef> Data da Venda </th>
          <td mat-cell *matCellDef="let element"> {{element.saleDate}} </td>
        </ng-container>

        <ng-container matColumnDef="installationDate">
          <th mat-header-cell *matHeaderCellDef> Data da Instalação </th>
          <td mat-cell *matCellDef="let element"> {{element.installationDate}} </td>
        </ng-container>

        <ng-container matColumnDef="period">
          <th mat-header-cell *matHeaderCellDef> Período </th>
          <td mat-cell *matCellDef="let element"> {{element.period}} </td>
        </ng-container>

        <ng-container matColumnDef="customerPhone">
          <th mat-header-cell *matHeaderCellDef> N° do Cliente </th>
          <td mat-cell *matCellDef="let element"> {{element.customerPhone}} </td>
        </ng-container>

        <ng-container matColumnDef="ticket">
          <th mat-header-cell *matHeaderCellDef> Ticket </th>
          <td mat-cell *matCellDef="let element"> {{element.ticket}} </td>
        </ng-container>

        <ng-container matColumnDef="os">
          <th mat-header-cell *matHeaderCellDef> OS </th>
          <td mat-cell *matCellDef="let element"> {{element.os}} </td>
        </ng-container>

        <ng-container matColumnDef="actions">
           <th mat-header-cell *matHeaderCellDef> Ações </th>
           <td mat-cell *matCellDef="let element">
             <button mat-icon-button color="primary" aria-label="Editar venda"><mat-icon>edit</mat-icon></button>
             <button mat-icon-button color="warn" aria-label="Excluir venda"><mat-icon>delete</mat-icon></button>
           </td>
        </ng-container>
        
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
    </div>
  </main>
</div>